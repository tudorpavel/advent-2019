(ns advent-test
  (:require [advent :refer :all]
            [clojure.test :refer :all]))

(deftest map-row-test
  (is (= [[1 0] [4 0]] (map-row ".#..#" 0)))
  )

(deftest make-points-test
  (is (= [[1 0] [4 0] [0 2] [1 2] [2 2]
          [3 2] [4 2] [4 3] [3 4] [4 4]]
         (make-points [".#..#"
                       "....."
                       "#####"
                       "....#"
                       "...##"])))
  )

(deftest line-equation-test
  (is (= [nil 1] (line-equation [1 3] [1 7])))
  (is (= [0   8] (line-equation [5 8] [2 8])))
  (is (= [1/3 0] (line-equation [3 1] [6 2])))
  )

(deftest point-on-line?-test
  (is (point-on-line? [1 9] [nil 1]))
  (is (point-on-line? [1 8] [0 8]))
  (is (point-on-line? [9 3] [1/3 0]))
  )

(deftest segments->point-set-test
  (is (= #{[1 2] [1 3] [1 4]}
         (segments->point-set ['([1 2] [1 3]) '([1 3] [1 4])])))
  )

(deftest best-monitoring-asteroid-test
  (is (= [[3 4] 8] (best-monitoring-asteroid
                    [".#..#"
                     "....."
                     "#####"
                     "....#"
                     "...##"])))

  (is (= [[5 8] 33] (best-monitoring-asteroid
                     ["......#.#."
                      "#..#.#...."
                      "..#######."
                      ".#.#.###.."
                      ".#..#....."
                      "..#....#.#"
                      "#..#....#."
                      ".##.#..###"
                      "##...#..#."
                      ".#....####"])))

  (is (= [[1 2] 35] (best-monitoring-asteroid
                     ["#.#...#.#."
                      ".###....#."
                      ".#....#..."
                      "##.#.#.#.#"
                      "....#.#.#."
                      ".##..###.#"
                      "..#...##.."
                      "..##....##"
                      "......#..."
                      ".####.###."])))

  (is (= [[6 3] 41] (best-monitoring-asteroid
                     [".#..#..###"
                      "####.###.#"
                      "....###.#."
                      "..###.##.#"
                      "##.##.#.#."
                      "....###..#"
                      "..#.#..#.#"
                      "#..#.#.###"
                      ".##...##.#"
                      ".....#.#.."])))

  (is (= [[11 13] 210] (best-monitoring-asteroid
                        [".#..##.###...#######"
                         "##.############..##."
                         ".#.######.########.#"
                         ".###.#######.####.#."
                         "#####.##.#.##.###.##"
                         "..#####..#.#########"
                         "####################"
                         "#.####....###.#.#.##"
                         "##.#################"
                         "#####.##.###..####.."
                         "..######..##.#######"
                         "####.##.####...##..#"
                         ".#####..#.######.###"
                         "##...#.##########..."
                         "#.##########.#######"
                         ".####.#.###.###.#.##"
                         "....##.##.###..#####"
                         ".#.#.###########.###"
                         "#.#.#.#####.####.###"
                         "###.##.####.##.#..##"])))
  )
